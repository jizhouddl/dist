(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b903098"],{"87d7":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=this,a=t.$createElement,r=t._self._c||a;return r("page-header-wrapper",[r("a-card",{attrs:{bordered:!1}},[r("div",{staticClass:"table-page-search-wrapper"},[r("a-form",{attrs:{layout:"inline"}},[r("a-row",{attrs:{gutter:48}},[r("a-col",{attrs:{md:8,sm:24}},[r("a-form-item",{attrs:{label:"职工姓名"}},[r("a-input",{attrs:{placeholder:"请输入完整姓名"},model:{value:t.queryParam.user__name,callback:function(e){t.$set(t.queryParam,"user__name",e)},expression:"queryParam.user__name"}})],1)],1),r("a-col",{attrs:{md:8,sm:24}},[r("a-form-item",{attrs:{label:"发票类型"}},[r("a-select",{attrs:{placeholder:"请选择","default-value":"0"},model:{value:t.queryParam.category,callback:function(e){t.$set(t.queryParam,"category",e)},expression:"queryParam.category"}},[r("a-select-option",{attrs:{value:"AL"}},[t._v("全部")]),r("a-select-option",{attrs:{value:"CO"}},[t._v("交通补贴")]),r("a-select-option",{attrs:{value:"TO"}},[t._v("疗休养")]),r("a-select-option",{attrs:{value:"RE"}},[t._v("亲属供养")]),r("a-select-option",{attrs:{value:"ME"}},[t._v("补充医疗")])],1)],1)],1),t.advanced?[r("a-col",{attrs:{md:8,sm:24}},[r("a-form-item",{attrs:{label:"发票状态"}},[r("a-select",{attrs:{placeholder:"请选择","default-value":"0"},model:{value:t.queryParam.status,callback:function(e){t.$set(t.queryParam,"status",e)},expression:"queryParam.status"}},[r("a-select-option",{attrs:{value:"0"}},[t._v("全部")]),r("a-select-option",{attrs:{value:"1"}},[t._v("未提交")]),r("a-select-option",{attrs:{value:"2"}},[t._v("已提交")]),r("a-select-option",{attrs:{value:"3"}},[t._v("已审核")]),r("a-select-option",{attrs:{value:"4"}},[t._v("已核销")])],1)],1)],1)]:t._e(),r("a-col",{attrs:{md:t.advanced?24:8,sm:24}},[r("span",{staticClass:"table-page-search-submitButtons",style:t.advanced&&{float:"right",overflow:"hidden"}||{}},[r("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.table.refresh(!0)}}},[t._v("查询")]),r("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(){return e.queryParam={}}}},[t._v("重置")]),r("a",{staticStyle:{"margin-left":"8px"},on:{click:t.toggleAdvanced}},[t._v(" "+t._s(t.advanced?"收起":"展开")+" "),r("a-icon",{attrs:{type:t.advanced?"up":"down"}})],1)],1)])],2)],1)],1),r("s-table",{ref:"table",attrs:{size:"default",rowKey:"id",columns:t.columns,data:t.loadData,rowSelection:t.rowSelection,showPagination:"auto"},scopedSlots:t._u([{key:"status",fn:function(e){return r("span",{},[r("a-badge",{attrs:{status:t._f("statusTypeFilter")(e),text:t._f("statusFilter")(e)}})],1)}},{key:"category",fn:function(e){return r("span",{},[r("a-badge",{attrs:{status:t._f("categoryFilter")(e),text:t._f("billFilter")(e)}})],1)}},{key:"action",fn:function(e,a){return r("span",{},[[r("a-popconfirm",{attrs:{title:"请确认是否审核通过?",okText:"确定",cancelText:"取消"},on:{confirm:function(){return t.onPass(a)}}},[r("a",[t._v("通过")])]),r("a-divider",{attrs:{type:"vertical"}}),r("a-popconfirm",{attrs:{title:"请确认是否审核退回?",okText:"确定",cancelText:"取消"},on:{confirm:function(){return t.onBack(a)}}},[r("a",[t._v("退回")])])]],2)}}])}),r("create-form",{key:t.timer,ref:"createModal",attrs:{visible:t.visible,loading:t.confirmLoading,model:t.mdl,userArray:t.selectedRows},on:{cancel:t.handleCancel,ok:t.handleOk}}),r("step-by-step-modal",{ref:"modal",on:{ok:t.handleOk}}),r("create-form-view",{ref:"createModalView",attrs:{visible:t.visibleView,userId:t.viewId,loading:t.confirmLoadingView},on:{ok:t.handleOkView,cancel:t.handleCancelView}}),r("create-form-check",{ref:"createModalCheck",attrs:{visible:t.visibleCheck,loading:t.confirmLoadingCheck,userArray:t.checkId},on:{cancel:t.handleCancelCheck,ok:t.handleOkCheck}})],1)],1)},n=[],s=a("5530");a("d3b7");function l(e,t,a,r,n,s,l){try{var i=e[s](l),o=i.value}catch(c){return void a(c)}i.done?t(o):Promise.resolve(o).then(r,n)}function i(e){return function(){var t=this,a=arguments;return new Promise((function(r,n){var s=e.apply(t,a);function i(e){l(s,r,n,i,o,"next",e)}function o(e){l(s,r,n,i,o,"throw",e)}i(void 0)}))}}a("96cf");var o=a("c1df"),c=a.n(o),u=a("2af9"),d=a("0fea"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"分步对话框",width:640,visible:e.visible,confirmLoading:e.confirmLoading},on:{cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-steps",{style:{marginBottom:"28px"},attrs:{current:e.currentStep,size:"small"}},[a("a-step",{attrs:{title:"基本信息"}}),a("a-step",{attrs:{title:"配置规则属性"}}),a("a-step",{attrs:{title:"设定调度周期"}})],1),a("a-form",{attrs:{form:e.form}},[a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.currentStep,expression:"currentStep === 0"}]},[a("a-form-item",{attrs:{label:"规则名称",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0}]}],expression:"['name', {rules: [{required: true}]}]"}]})],1),a("a-form-item",{attrs:{label:"规则描述",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["desc",{rules:[{required:!0}]}],expression:"['desc', {rules: [{required: true}]}]"}],attrs:{rows:4}})],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:1===e.currentStep,expression:"currentStep === 1"}]},[a("a-form-item",{attrs:{label:"监控对象",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["target",{initialValue:0,rules:[{required:!0}]}],expression:"['target', {initialValue: 0, rules: [{required: true}]}]"}],staticStyle:{width:"100%"}},[a("a-select-option",{attrs:{value:0}},[e._v("表一")]),a("a-select-option",{attrs:{value:1}},[e._v("表二")])],1)],1),a("a-form-item",{attrs:{label:"规则模板",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["template",{initialValue:0,rules:[{required:!0}]}],expression:"['template', { initialValue: 0, rules: [{required: true}]}]"}],staticStyle:{width:"100%"}},[a("a-select-option",{attrs:{value:0}},[e._v("规则模板一")]),a("a-select-option",{attrs:{value:1}},[e._v("规则模板二")])],1)],1),a("a-form-item",{attrs:{label:"规则类型",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["type",{initialValue:0,rules:[{required:!0}]}],expression:"['type', {initialValue: 0, rules: [{required: true}]}]"}],staticStyle:{width:"100%"}},[a("a-radio",{attrs:{value:0}},[e._v("强")]),a("a-radio",{attrs:{value:1}},[e._v("弱")])],1)],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:2===e.currentStep,expression:"currentStep === 2"}]},[a("a-form-item",{attrs:{label:"开始时间",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["time",{rules:[{type:"object",required:!0,message:"Please select time!"}]}],expression:"['time', {rules: [{ type: 'object', required: true, message: 'Please select time!' }]}]"}],staticStyle:{width:"100%"}})],1),a("a-form-item",{attrs:{label:"调度周期",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["frequency",{initialValue:"month",rules:[{required:!0}]}],expression:"['frequency', { initialValue: 'month', rules: [{required: true}]}]"}],staticStyle:{width:"100%"}},[a("a-select-option",{attrs:{value:"month"}},[e._v("月")]),a("a-select-option",{attrs:{value:"week"}},[e._v("周")])],1)],1)],1)])],1),a("template",{slot:"footer"},[e.currentStep>0?a("a-button",{key:"back",style:{float:"left"},on:{click:e.backward}},[e._v("上一步")]):e._e(),a("a-button",{key:"cancel",on:{click:e.handleCancel}},[e._v("取消")]),a("a-button",{key:"forward",attrs:{loading:e.confirmLoading,type:"primary"},on:{click:function(t){return e.handleNext(e.currentStep)}}},[e._v(e._s(2===e.currentStep?"完成":"下一步"))])],1)],2)},f=[],m=a("88bc"),h=a.n(m),b=[["name","desc"],["target","template","type"],["time","frequency"]],y={name:"StepByStepModal",data:function(){return{labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}},visible:!1,confirmLoading:!1,currentStep:0,mdl:{},form:this.$form.createForm(this)}},methods:{edit:function(e){this.visible=!0;var t=this.form.setFieldsValue;this.$nextTick((function(){t(h()(e,[]))}))},handleNext:function(e){var t=this,a=this.form.validateFields,r=e+1;r<=2?a(b[this.currentStep],(function(e,a){e||(t.currentStep=r)})):(this.confirmLoading=!0,a((function(e,a){e?t.confirmLoading=!1:setTimeout((function(){t.confirmLoading=!1,t.$emit("ok",a)}),1500)})))},backward:function(){this.currentStep--},handleCancel:function(){this.visible=!1,this.currentStep=0}}},v=y,g=a("2877"),w=Object(g["a"])(v,p,f,!1,null,null,null),k=w.exports,x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{bodyStyle:{height:"2000"},title:"批量审核",width:650,visible:e.visible,loading:e.loading},on:{ok:function(){e.$emit("ok")},cancel:function(){e.$emit("cancel")}}},[a("a-spin",{attrs:{spinning:e.loading}},[a("a-tabs",{attrs:{type:"card",defaultActiveKey:""},on:{change:e.callback}},e._l(e.userArray,(function(t,r){return a("a-tab-pane",{key:t.id,attrs:{tab:""+t.user_name}},[a("s-table",{ref:"table",refInFor:!0,attrs:{size:"default",rowKey:function(e){return e.id},columns:e.columns,data:e.loadData,rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange}},scopedSlots:e._u([{key:"category",fn:function(t){return a("span",{},[a("a-badge",{attrs:{status:e._f("billTypeFilter")(t),text:e._f("billFilter")(t)}})],1)}}],null,!0)}),a("s-table",{ref:"tablePaper",refInFor:!0,attrs:{size:"default",rowKey:function(e){return e.id},columns:e.columnsPaper,data:e.loadDataPaper,rowSelection:{selectedRowKeys:e.selectedRowKeysPaper,onChange:e.onSelectChangePaper}},scopedSlots:e._u([{key:"billTypePaper",fn:function(t){return a("span",{},[a("a-badge",{attrs:{status:e._f("billTypeFilterPaper")(t),text:e._f("billFilterPaper")(t)}})],1)}}],null,!0)}),a("a-button",{attrs:{type:"primary"},on:{click:e.pass}},[e._v("通过")]),a("a-button",{staticStyle:{"margin-left":"10px"},on:{click:e.back}},[e._v("退回")])],1)})),1),a("create-form-pass",{key:e.timer,ref:"createModal",attrs:{loading:e.confirmLoading,visible:e.visiblePass,model:e.mdl,passRecord:e.selectRowsAll,passOrBack:e.passOrBackFlag},on:{cancel:e.handleCancel,ok:e.handleOk}})],1)],1)},P=[],_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{width:800,visible:e.visible,loading:e.loading},on:{ok:function(){e.$emit("ok")},cancel:function(){e.$emit("cancel")}}},[a("a-spin",{attrs:{spinning:e.loading}},[a("s-table",{ref:"table",attrs:{size:"default",rowKey:function(e){return e.id},columns:e.columns,data:e.loadData}})],1)],1)},C=[],R=[{title:"姓名",dataIndex:"name"},{title:"电子票数量",dataIndex:"electricNum"},{title:"纸质票数量",dataIndex:"paperNum"},{title:"报销批次",dataIndex:"expenseBatch"},{title:"金额总计",dataIndex:"totalMoney"}],S={components:{STable:u["b"]},props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){return null}},passRecord:{type:Object,default:function(){return null}},passOrBack:{type:Boolean,default:function(){return!1}}},data:function(){var e=this;return this.columns=R,this.formLayout={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}}},{queryParam:{},loadData:function(t){var a=Object.assign({},t,e.passRecord);return e.passOrBack?e.passOrBack?Object(d["e"])(a).then((function(e){return e.result})):void 0:Object(d["d"])(a).then((function(e){return e.result}))},selectedRowKeys:[],selectedRows:[]}},filters:{},created:function(){},computed:{},methods:{}},O=S,F=Object(g["a"])(O,_,C,!1,null,null,null),q=F.exports,I=[{title:"发票识别",dataIndex:"type"},{title:"发票抬头",dataIndex:"buyer_name"},{title:"发票类型",dataIndex:"category",scopedSlots:{customRender:"category"}},{title:"金额",dataIndex:"total"}],j={AL:{status:"default",text:"全部"},CO:{status:"default",text:"交通补贴"},TO:{status:"success",text:"疗休养"},RE:{status:"error",text:"亲属供养"},ME:{status:"processing",text:"补充医疗"},OT:{status:"default",text:"其他"}},$=[{title:"发票识别",dataIndex:"billRecognizePaper"},{title:"张数",dataIndex:"billAccountPaper"},{title:"发票类型",dataIndex:"billTypePaper",scopedSlots:{customRender:"billTypePaper"}},{title:"发票金额",dataIndex:"billMoneyPaper"}],T={components:{STable:u["b"],CreateFormPass:q},props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){return null}},userArray:{type:Array,default:function(){return null}}},data:function(){var e=this;return this.columns=I,this.columnsPaper=$,this.formLayout={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}}},{form:this.$form.createForm(this),queryParam:{},loadData:function(t){var a=Object.assign({},t,e.queryParam);return Object(d["i"])(a).then((function(e){var a={};return a.pageNo=t.pageNo,a.pageSize=t.pageSize,a.totalPage=Math.ceil(e.data.count/t.pageSize),a.totalCount=e.data.count,a.data=[],a.data.push(e.data.results[0].invoice_detail),a.data[0].total=e.data.results[0].total,a.data[0].category=e.data.results[0].category,a}))},loadDataPaper:function(t){var a=Object.assign({},t,e.queryParam);return Object(d["j"])(a).then((function(e){return e.result}))},selectedRowKeys:[],selectedRows:[],selectedRowKeysPaper:[],selectedRowsPaper:[],visiblePass:!1,confirmLoading:!1,mdl:null,selectRowsAll:{},visibleBack:!1,confirmLoadingBack:!1,mdlBack:null,passOrBackFlag:!1,timer:""}},filters:{billFilter:function(e){return j[e].text},billTypeFilter:function(e){return j[e].status},billFilterPaper:function(e){return j[e].text},billTypeFilterPaper:function(e){return j[e].status}},created:function(){},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}},methods:{onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t,this.selectRowsAll.selectedRows=this.selectedRows},onSelectChangePaper:function(e,t){this.selectedRowKeysPaper=e,this.selectedRowsPaper=t,this.selectRowsAll.selectedRowsPaper=this.selectedRowsPaper},callback:function(e){this.queryParam.id=e},pass:function(){this.timer=(new Date).getTime(),this.visiblePass=!0,this.mdl=null},back:function(){this.timer=(new Date).getTime(),this.passOrBackFlag=!0,this.visiblePass=!0,this.mdlBack=null},handleCancel:function(){var e=this;return i(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.visiblePass=!1,e.passOrBackFlag=!1;case 2:case"end":return t.stop()}}),t)})))()},handleOk:function(){var e=this;return i(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.selectRowsAll,e.passOrBackFlag){t.next=6;break}return t.next=4,Object(d["f"])(a).then((function(t){200==t.result.status?(e.$message.info("已审核通过"),e.visiblePass=!1,e.passOrBackFlag=!1):200!=t.result.status&&e.$message.error("请再次审核")}));case 4:t.next=9;break;case 6:if(!e.passOrBackFlag){t.next=9;break}return t.next=9,Object(d["b"])(a).then((function(t){200==t.result.status?(e.$message.info("已审核退回"),e.visiblePass=!1,e.passOrBackFlag=!1):200!=t.result.status&&e.$message.error("请再次审核")}));case 9:case"end":return t.stop()}}),t)})))()}}},B=T,K=Object(g["a"])(B,x,P,!1,null,null,null),A=K.exports,L=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{bodyStyle:{height:"2000"},title:"批量审核",width:650,visible:e.visible,loading:e.loading},on:{ok:function(){e.$emit("ok")},cancel:function(){e.$emit("cancel")}}},[a("a-spin",{attrs:{spinning:e.loading}},[a("a-tabs",{attrs:{type:"card",defaultActiveKey:""},on:{change:e.callback}},e._l(e.userId,(function(t,r){return a("a-tab-pane",{key:t.id,attrs:{tab:""+t.name}},[a("s-table",{ref:"table",refInFor:!0,attrs:{size:"default",rowKey:function(e){return e.id},columns:e.columns,data:e.loadData},scopedSlots:e._u([{key:"billType",fn:function(t){return a("span",{},[a("a-badge",{attrs:{status:e._f("billTypeFilter")(t),text:e._f("billFilter")(t)}})],1)}}],null,!0)}),a("s-table",{ref:"tablePaper",refInFor:!0,attrs:{size:"default",rowKey:function(e){return e.id},columns:e.columnsPaper,data:e.loadDataPaper},scopedSlots:e._u([{key:"billTypePaper",fn:function(t){return a("span",{},[a("a-badge",{attrs:{status:e._f("billTypeFilterPaper")(t),text:e._f("billFilterPaper")(t)}})],1)}}],null,!0)})],1)})),1)],1)],1)},V=[],M=[{title:"发票识别",dataIndex:"billRecognize"},{title:"发票抬头",dataIndex:"billTitle"},{title:"发票类型",dataIndex:"billType",scopedSlots:{customRender:"billType"}},{title:"发票金额",dataIndex:"billMoney"}],D={1:{status:"default",text:"交通补贴"},2:{status:"success",text:"疗休养"},3:{status:"error",text:"亲属供养"}},z=[{title:"发票识别",dataIndex:"billRecognizePaper"},{title:"张数",dataIndex:"billAccountPaper"},{title:"发票类型",dataIndex:"billTypePaper",scopedSlots:{customRender:"billTypePaper"}},{title:"发票金额",dataIndex:"billMoneyPaper"}],N={components:{STable:u["b"]},props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},userId:{type:Array,required:!0}},data:function(){var e=this;return this.columns=M,this.columnsPaper=z,this.formLayout={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}}},{form:this.$form.createForm(this),queryParam:{},loadData:function(t){var a=Object.assign({},t,e.queryParam);return Object(d["k"])(a).then((function(e){return e.result}))},loadDataPaper:function(t){var a=Object.assign({},t,e.queryParam);return Object(d["j"])(a).then((function(e){return e.result}))},selectedRowKeys:[],selectedRows:[],selectedRowKeysPaper:[],selectedRowsPaper:[],selectRowsAll:{}}},filters:{billFilter:function(e){return D[e].text},billTypeFilter:function(e){return D[e].status},billFilterPaper:function(e){return D[e].text},billTypeFilterPaper:function(e){return D[e].status}},created:function(){},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}},methods:{onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t,this.selectRowsAll.selectedRows=this.selectedRows},onSelectChangePaper:function(e,t){this.selectedRowKeysPaper=e,this.selectedRowsPaper=t,this.selectRowsAll.selectedRowsPaper=this.selectedRowsPaper},callback:function(e){this.queryParam.userId=e}}},E=N,Y=Object(g["a"])(E,L,V,!1,null,null,null),J=Y.exports,G=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{bodyStyle:{height:"2000"},title:"批量审核",width:650,visible:e.visible,loading:e.loading},on:{ok:function(){e.$emit("ok")},cancel:function(){e.$emit("cancel")}}},[a("a-spin",{attrs:{spinning:e.loading}},[a("a-tabs",{attrs:{type:"card",defaultActiveKey:""},on:{change:e.callback}},e._l(e.userArray,(function(t,r){return a("a-tab-pane",{key:t.id,attrs:{tab:""+t.name}},[a("s-table",{ref:"table",refInFor:!0,attrs:{size:"default",rowKey:function(e){return e.id},columns:e.columns,data:e.loadData,rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange}},scopedSlots:e._u([{key:"billType",fn:function(t){return a("span",{},[a("a-badge",{attrs:{status:e._f("billTypeFilter")(t),text:e._f("billFilter")(t)}})],1)}}],null,!0)}),a("s-table",{ref:"tablePaper",refInFor:!0,attrs:{size:"default",rowKey:function(e){return e.id},columns:e.columnsPaper,data:e.loadDataPaper,rowSelection:{selectedRowKeys:e.selectedRowKeysPaper,onChange:e.onSelectChangePaper}},scopedSlots:e._u([{key:"billTypePaper",fn:function(t){return a("span",{},[a("a-badge",{attrs:{status:e._f("billTypeFilterPaper")(t),text:e._f("billFilterPaper")(t)}})],1)}}],null,!0)}),a("a-button",{attrs:{type:"primary"},on:{click:e.pass}},[e._v("通过")]),a("a-button",{staticStyle:{"margin-left":"10px"},on:{click:e.back}},[e._v("退回")])],1)})),1),a("create-form-pass",{key:e.timer,ref:"createModal",attrs:{loading:e.confirmLoading,visible:e.visiblePass,model:e.mdl,passRecord:e.selectRowsAll,passOrBack:e.passOrBackFlag},on:{cancel:e.handleCancel,ok:e.handleOk}})],1)],1)},H=[],Q=[{title:"发票识别",dataIndex:"billRecognize"},{title:"发票抬头",dataIndex:"billTitle"},{title:"发票类型",dataIndex:"billType",scopedSlots:{customRender:"billType"}},{title:"发票金额",dataIndex:"billMoney"}],U={1:{status:"default",text:"交通补贴"},2:{status:"success",text:"疗休养"},3:{status:"error",text:"亲属供养"}},W=[{title:"发票识别",dataIndex:"billRecognizePaper"},{title:"张数",dataIndex:"billAccountPaper"},{title:"发票类型",dataIndex:"billTypePaper",scopedSlots:{customRender:"billTypePaper"}},{title:"发票金额",dataIndex:"billMoneyPaper"}],X={components:{STable:u["b"],CreateFormPass:q},props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){return null}},userArray:{type:Array,default:function(){return null}}},data:function(){var e=this;return this.columns=Q,this.columnsPaper=W,this.formLayout={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}}},{form:this.$form.createForm(this),queryParam:{},loadData:function(t){var a=Object.assign({},t,e.queryParam);return Object(d["k"])(a).then((function(e){return e.result}))},loadDataPaper:function(t){var a=Object.assign({},t,e.queryParam);return Object(d["j"])(a).then((function(e){return e.result}))},selectedRowKeys:[],selectedRows:[],selectedRowKeysPaper:[],selectedRowsPaper:[],visiblePass:!1,confirmLoading:!1,mdl:null,selectRowsAll:{},visibleBack:!1,confirmLoadingBack:!1,mdlBack:null,passOrBackFlag:!1,timer:""}},filters:{billFilter:function(e){return U[e].text},billTypeFilter:function(e){return U[e].status},billFilterPaper:function(e){return U[e].text},billTypeFilterPaper:function(e){return U[e].status}},created:function(){},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}},methods:{onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t,this.selectRowsAll.selectedRows=this.selectedRows},onSelectChangePaper:function(e,t){this.selectedRowKeysPaper=e,this.selectedRowsPaper=t,this.selectRowsAll.selectedRowsPaper=this.selectedRowsPaper},callback:function(e){this.queryParam.userId=e},pass:function(){this.timer=(new Date).getTime(),this.visiblePass=!0,this.mdl=null},back:function(){this.timer=(new Date).getTime(),this.passOrBackFlag=!0,this.visiblePass=!0,this.mdlBack=null},handleCancel:function(){var e=this;return i(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.visiblePass=!1,e.passOrBackFlag=!1;case 2:case"end":return t.stop()}}),t)})))()},handleOk:function(){var e=this;return i(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.selectRowsAll,e.passOrBackFlag){t.next=6;break}return t.next=4,Object(d["f"])(a).then((function(t){200==t.result.status?(e.$message.info("已审核通过"),e.visiblePass=!1,e.passOrBackFlag=!1):200!=t.result.status&&e.$message.error("请再次审核")}));case 4:t.next=9;break;case 6:if(!e.passOrBackFlag){t.next=9;break}return t.next=9,Object(d["b"])(a).then((function(t){200==t.result.status?(e.$message.info("已审核退回"),e.visiblePass=!1,e.passOrBackFlag=!1):200!=t.result.status&&e.$message.error("请再次审核")}));case 9:case"end":return t.stop()}}),t)})))()}}},Z=X,ee=Object(g["a"])(Z,G,H,!1,null,null,null),te=ee.exports,ae=[{title:"职工姓名",dataIndex:"user_name",width:"100px"},{title:"发票类型",dataIndex:"category",width:"100px",scopedSlots:{customRender:"category"}},{title:"发票识别",dataIndex:"type",width:"100px"},{title:"发票号码",dataIndex:"number",width:"100px"},{title:"报销批次",dataIndex:"batch",width:"150px",scopedSlots:{customRender:"batch"}},{title:"发票金额",dataIndex:"total",width:"150px",scopedSlots:{customRender:"total"}},{title:"状态",dataIndex:"status",width:"100px"},{title:"提交时间",dataIndex:"create_time",width:"150px",sorter:!0},{title:"操作",dataIndex:"action",width:"150px",scopedSlots:{customRender:"action"}}],re={AL:{status:"default",text:"全部"},CO:{status:"default",text:"交通补贴"},TO:{status:"success",text:"疗休养"},RE:{status:"error",text:"亲属供养"},ME:{status:"processing",text:"补充医疗"},OT:{status:"default",text:"其他"}},ne={1:{status:"default",text:"未提交"},2:{status:"error",text:"已提交"},3:{status:"default",text:"已审核"},4:{status:"success",text:"已核销"}},se={name:"BillCheck",components:{STable:u["b"],Ellipsis:u["a"],CreateForm:A,StepByStepModal:k,CreateFormView:J,CreateFormCheck:te},data:function(){var e=this;return this.columns=ae,{visible:!1,confirmLoading:!1,mdl:null,advanced:!1,queryParam:{},loadData:function(){var t=i(regeneratorRuntime.mark((function t(a){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("AL"==e.queryParam.category&&(e.queryParam.category=""),"4"==e.queryParam.status?(e.queryParam.is_submitted=!0,e.queryParam.is_cherked=!0,e.queryParam.is_verified=!0):"3"==e.queryParam.status?(e.queryParam.is_submitted=!0,e.queryParam.is_cherked=!0,e.queryParam.is_verified=!1):"2"==e.queryParam.status?(e.queryParam.is_submitted=!0,e.queryParam.is_cherked=!1,e.queryParam.is_verified=!1):"1"==e.queryParam.status&&(e.queryParam.is_submitted=!1,e.queryParam.is_cherked=!1,e.queryParam.is_verified=!1),!a){t.next=7;break}return r=Object.assign({page:a.pageNo,size:a.pageSize},e.queryParam),t.next=6,Object(d["i"])(r).then((function(t){var r={data:[],pageNo:"",totalPage:"",totalCount:"",pageSize:""};for(var n in r.totalPage=Math.ceil(t.data.count/a.pageSize),r.pageNo=a.pageNo,r.pageSize=a.pageSize,r.totalCount=t.data.count,r.data=t.data.results,r.data){var s="-1";r.data[n].is_verified?s="已核销":r.data[n].is_cherked?s="已审核":r.data[n].is_submitted?s="已提交":r.data[n].is_submitted||(s="未提交"),r.data[n].status=s;var l=r.data[n].create_time;r.data[n].create_time=c()(l).format("YYYY-MM-DD"),r.data[n].type=r.data[n].invoice_detail.type}return e.queryParam.is_submitted=null,e.queryParam.is_cherked=null,e.queryParam.is_verified=null,r}));case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})));function a(e){return t.apply(this,arguments)}return a}(),selectedRowKeys:[],selectedRows:[],timer:"",visibleView:!1,viewId:[],confirmLoadingView:!1,checkId:[],visibleCheck:!1,confirmLoadingCheck:!1}},filters:{statusFilter:function(e){return ne[e].text},statusTypeFilter:function(e){return ne[e].status},billFilter:function(e){return re[e].text},categoryFilter:function(e){return re[e].status}},created:function(){Object(d["p"])({t:new Date})},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}},methods:{handleAllCheck:function(){this.selectedRows.length>0?(this.visible=!0,this.mdl=null):this.selectedRows.length<=0&&this.$message.error("请选择需要审核的发票！")},handleCheck:function(e){this.visibleCheck=!0,this.checkId[0]=e},handleView:function(e){this.visibleView=!0,this.mdl=Object(s["a"])({},e),this.viewId[0]=e},handleOk:function(){var e=this,t=this.$refs.createModal.form;this.confirmLoading=!0,t.validateFields((function(a,r){e.$refs.table.refresh(),e.timer=(new Date).getTime(),e.visible=!1,e.confirmLoading=!1,t.resetFields(),e.$refs.table.refresh()}))},handleCancel:function(){var e=this,t=this.$refs.createModal.form;this.confirmLoading=!0,t.validateFields((function(a,r){e.timer=(new Date).getTime(),e.visible=!1,e.confirmLoading=!1,t.resetFields(),e.$refs.table.refresh()}))},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},toggleAdvanced:function(){this.advanced=!this.advanced},resetSearchForm:function(){this.queryParam={date:c()(new Date)}},handleOkView:function(){var e=this,t=this.$refs.createModalView.form;this.confirmLoadingView=!0,t.validateFields((function(a,r){e.visibleView=!1,e.confirmLoadingView=!1,t.resetFields(),e.$refs.table.refresh()}))},handleCancelView:function(){var e=this,t=this.$refs.createModalView.form;this.confirmLoadingView=!0,t.validateFields((function(a,r){e.visibleView=!1,e.confirmLoadingView=!1,t.resetFields(),e.$refs.table.refresh()}))},handleCancelCheck:function(){var e=this,t=this.$refs.createModalCheck.form;this.confirmLoadingCheck=!0,t.validateFields((function(a,r){e.visibleCheck=!1,e.confirmLoadingCheck=!1,t.resetFields(),e.$refs.table.refresh()}))},handleOkCheck:function(){var e=this,t=this.$refs.createModalCheck.form;this.confirmLoadingCheck=!0,t.validateFields((function(a,r){e.visibleCheck=!1,e.confirmLoadingCheck=!1,t.resetFields(),e.$refs.table.refresh()}))},onPass:function(e){var t=this;if(e.is_cherked)this.$message.error("发票已经审核通过,无法再次审核！");else if(!e.is_cherked&&e.is_submitted){var a={is_cherked:!0,invoice_detail:{}};Object(d["w"])(a,e.id).then((function(e){200==e.status?(t.$message.success("发票审核通过！"),t.$refs.table.refresh()):t.$message.error("发票审核失败！")}))}},onBack:function(e){var t=this;if(e.is_verified)this.$message.error("发票已经核销通过,无法退回！");else if(e.is_submitted){var a={is_cherked:!1,is_submitted:!1,invoice_detail:{}};Object(d["w"])(a,e.id).then((function(e){200==e.status?(t.$message.success("发票退回成功！"),t.$refs.table.refresh()):t.$message.error("发票退回失败！")}))}}}},le=se,ie=Object(g["a"])(le,r,n,!1,null,null,null);t["default"]=ie.exports},"88bc":function(e,t,a){(function(t){var a=1/0,r=9007199254740991,n="[object Arguments]",s="[object Function]",l="[object GeneratorFunction]",i="[object Symbol]",o="object"==typeof t&&t&&t.Object===Object&&t,c="object"==typeof self&&self&&self.Object===Object&&self,u=o||c||Function("return this")();function d(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}function p(e,t){var a=-1,r=e?e.length:0,n=Array(r);while(++a<r)n[a]=t(e[a],a,e);return n}function f(e,t){var a=-1,r=t.length,n=e.length;while(++a<r)e[n+a]=t[a];return e}var m=Object.prototype,h=m.hasOwnProperty,b=m.toString,y=u.Symbol,v=m.propertyIsEnumerable,g=y?y.isConcatSpreadable:void 0,w=Math.max;function k(e,t,a,r,n){var s=-1,l=e.length;a||(a=C),n||(n=[]);while(++s<l){var i=e[s];t>0&&a(i)?t>1?k(i,t-1,a,r,n):f(n,i):r||(n[n.length]=i)}return n}function x(e,t){return e=Object(e),P(e,t,(function(t,a){return a in e}))}function P(e,t,a){var r=-1,n=t.length,s={};while(++r<n){var l=t[r],i=e[l];a(i,l)&&(s[l]=i)}return s}function _(e,t){return t=w(void 0===t?e.length-1:t,0),function(){var a=arguments,r=-1,n=w(a.length-t,0),s=Array(n);while(++r<n)s[r]=a[t+r];r=-1;var l=Array(t+1);while(++r<t)l[r]=a[r];return l[t]=s,d(e,this,l)}}function C(e){return O(e)||S(e)||!!(g&&e&&e[g])}function R(e){if("string"==typeof e||B(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}function S(e){return q(e)&&h.call(e,"callee")&&(!v.call(e,"callee")||b.call(e)==n)}var O=Array.isArray;function F(e){return null!=e&&j(e.length)&&!I(e)}function q(e){return T(e)&&F(e)}function I(e){var t=$(e)?b.call(e):"";return t==s||t==l}function j(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}function $(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function T(e){return!!e&&"object"==typeof e}function B(e){return"symbol"==typeof e||T(e)&&b.call(e)==i}var K=_((function(e,t){return null==e?{}:x(e,p(k(t,1),R))}));e.exports=K}).call(this,a("c8ba"))}}]);