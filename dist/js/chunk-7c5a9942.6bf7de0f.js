(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7c5a9942"],{"0fea":function(e,t,a){"use strict";a.d(t,"p",(function(){return n})),a.d(t,"i",(function(){return o})),a.d(t,"k",(function(){return l})),a.d(t,"j",(function(){return c})),a.d(t,"d",(function(){return s})),a.d(t,"e",(function(){return u})),a.d(t,"f",(function(){return d})),a.d(t,"b",(function(){return m})),a.d(t,"x",(function(){return b})),a.d(t,"t",(function(){return p})),a.d(t,"m",(function(){return f})),a.d(t,"n",(function(){return h})),a.d(t,"w",(function(){return v})),a.d(t,"u",(function(){return g})),a.d(t,"v",(function(){return y})),a.d(t,"o",(function(){return k})),a.d(t,"l",(function(){return _})),a.d(t,"c",(function(){return O})),a.d(t,"q",(function(){return w})),a.d(t,"s",(function(){return j})),a.d(t,"r",(function(){return C})),a.d(t,"a",(function(){return R})),a.d(t,"g",(function(){return S})),a.d(t,"h",(function(){return I}));var i=a("b775"),r={user:"/user",role:"/role",service:"/service",permission:"/permission",permissionNoPager:"/permission/no-pager",orgTree:"/org/tree",billCheckList:"/invoices/",billCheckQuery:"/billCheck/query",billCheckPerson:"/billCheck/person",billCheckPaper:"/billCheck/paper",billCheckPass:"/billCheck/checkPass",billCount:"/billCheck/billCount",billCountBack:"/billCheck/billCountBack",billSubmit:"/billCheck/billSubmit",billBackSubmit:"/billCheck/billBackSubmit",billBatch:"/invoice/batchscount/",billUnit:"/invoice/batchscount",billPersonE:"/invoices",billPerson:"/invoices",reviewBill:"/invoice/batchscount/",invoiceRespository:"/invoices/",invoiceQuota:"/quota",invoiceRecognition:"/invoicedetails/",dataControl:"/invoice/transportation_allowances/?page=1&page_size=1",financialSummary:"/invoice/transportation_allowances_finance_show/?page=1&page_size=1",electronicLedger:"/invoice/transportation_allowances_eleshow/?page=1&page_size=1",billbackquery:"/invoice_return_search/",billbackcheck:"/invoice/return_affirm/",backBillok:"/invoice/invoice_return/",billbacklist:"/invoices/",information:"/invoice/user_information/",addBatch:"/batchs/",getBatch:"/batchs"};function n(e){return Object(i["b"])({url:r.role,method:"get",params:e})}function o(e){return Object(i["b"])({url:r.billCheckList,method:"get",params:e})}function l(e){return Object(i["b"])({url:r.billCheckPerson,method:"get",params:e})}function c(e){return Object(i["b"])({url:r.billCheckPaper,method:"get",params:e})}function s(e){return Object(i["b"])({url:r.billCount,method:"post",data:e})}function u(e){return Object(i["b"])({url:r.billCountBack,method:"post",data:e})}function d(e){return Object(i["b"])({url:r.billSubmit,method:"post",data:e})}function m(e){return Object(i["b"])({url:r.billBackSubmit,method:"post",data:e})}function b(e){return Object(i["b"])({url:r.reviewBill,method:"put",data:e})}function p(e){return Object(i["b"])({url:r.invoiceRespository,method:"post",data:e})}function f(e){return Object(i["b"])({url:r.invoiceRespository,method:"get",params:e})}function h(e){return Object(i["b"])({url:r.invoiceQuota,method:"get",params:e})}function v(e,t){return Object(i["b"])({url:r.invoiceRespository+t+"/",method:"put",data:e})}function g(e,t){return Object(i["b"])({url:r.invoiceRespository+t+"/",method:"delete"})}function y(e){return Object(i["b"])({url:r.invoiceRecognition,method:"post",headers:{"Content-Type":"multipart/form-data"},data:e})}function k(e){return Object(i["b"])({url:r.dataControl,method:"post",data:e})}function _(e){return Object(i["b"])({url:r.billbacklist,method:"get",params:e})}function O(e){return Object(i["b"])({url:r.billbackquery,method:"post",params:e})}function w(e){return Object(i["b"])({url:r.backBillok,method:"post",params:e})}function j(e){return Object(i["b"])({url:r.information,method:"post",data:e})}function C(e){return Object(i["b"])({url:r.getBatch,method:"get",params:e})}function R(e){return Object(i["b"])({url:r.addBatch,method:"post",data:e})}function S(e){return Object(i["b"])({url:r.addBatch+e+"/",method:"delete"})}function I(e){return Object(i["b"])({url:r.addBatch+e+"/",method:"put"})}},2909:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var i=a("6b75");function r(e){if(Array.isArray(e))return Object(i["a"])(e)}a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("a630");function n(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var o=a("06c5");function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e){return r(e)||n(e)||Object(o["a"])(e)||l()}},f7a7:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("page-header-wrapper",[a("a-card",{attrs:{bordered:!1}},[a("a-tabs",{attrs:{"default-active-key":"1",type:"card"}},[a("a-tab-pane",{key:"1",attrs:{tab:"电子票"}},[a("a-row",[a("a-col",{attrs:{span:9}},[a("h3",[a("b",[e._v("自动识别")])]),a("span",[e._v("上传附件：")]),a("a-upload",{attrs:{"file-list":e.fileList,remove:e.handleRemove,"before-upload":e.beforeUpload,headers:e.headers}},[a("a-button",[a("a-icon",{attrs:{type:"upload"}}),e._v(" 选择文件 ")],1)],1),a("a-button",{staticStyle:{"margin-top":"16px"},attrs:{type:"primary",disabled:0===e.fileList.length,loading:e.uploading},on:{click:e.handleUpload}},[e._v(" "+e._s(e.upload_status?"上传中":"开始识别")+" ")]),a("span",{domProps:{innerHTML:e._s("&emsp;&emsp;&emsp;&emsp;&emsp;支持扩展名： .png .otd .pdf .jpg")}})],1),a("a-col",{attrs:{span:10}},[a("a-tabs",{attrs:{"default-active-key":"1",type:"editable-card","hide-add":""},on:{edit:e.onEditElec}},e._l(e.elecItems,(function(t){return a("a-tab-pane",{key:t.key,attrs:{tab:t.key,closable:t.closable}},[a("a-form-model",{ref:"ruleForm",refInFor:!0,attrs:{"label-col":{span:5},"wrapper-col":{span:19},rules:e.rules,model:t}},[a("a-form-model-item",{attrs:{label:"发票号码",prop:"number"}},[a("a-input",{staticStyle:{width:"90%"},model:{value:t.number,callback:function(a){e.$set(t,"number",a)},expression:"item.number"}})],1),a("a-form-model-item",{attrs:{label:"开票日期",prop:"invoice_detail.issue_date"}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["date-picker"],expression:"['date-picker']"}],staticStyle:{width:"90%"},attrs:{format:"YYYY-MM-DD",type:"date"},model:{value:t.invoice_detail.issue_date,callback:function(a){e.$set(t.invoice_detail,"issue_date",a)},expression:"item.invoice_detail.issue_date"}})],1),a("a-form-model-item",{attrs:{label:"发票金额",prop:"total"}},[a("a-input-number",{staticStyle:{width:"90%"},attrs:{min:0,max:1e7},model:{value:t.total,callback:function(a){e.$set(t,"total",a)},expression:"item.total"}})],1),a("a-form-model-item",{attrs:{label:"发票类型",prop:"category"}},[a("a-radio-group",{model:{value:t.category,callback:function(a){e.$set(t,"category",a)},expression:"item.category"}},[a("a-radio",{attrs:{value:"CO"}},[e._v(" 交通补贴 ")]),a("a-radio",{attrs:{value:"TO"}},[e._v(" 疗休养 ")]),a("a-radio",{attrs:{value:"RE"}},[e._v(" 亲属供养 ")])],1)],1),a("a-form-model-item",[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitToRespository("ruleForm")}}},[e._v(" 完成 ")]),a("a-button",{staticStyle:{"margin-left":"30px"},attrs:{href:e.url},on:{click:e.resetBack}},[e._v(" 返回发票仓库 ")])],1)],1)],1)})),1)],1)],1)],1),a("a-tab-pane",{key:"2",attrs:{tab:"纸质票"}},[a("a-row",[a("a-col",{attrs:{span:9}},[a("h3",[a("b",[e._v("发票信息")])]),a("a-tabs",{attrs:{"default-active-key":"1",type:"editable-card","hide-add":""},on:{edit:e.onEdit}},e._l(e.items,(function(t){return a("a-tab-pane",{key:t.key,attrs:{tab:t.key,closable:t.closable}},[a("a-form-model",{ref:"paperRuleForm",refInFor:!0,attrs:{"label-col":{span:5},"wrapper-col":{span:22},rules:e.paperRules,model:t}},[a("a-form-model-item",{attrs:{label:"发票张数",prop:"invoice_detail.remarks"}},[a("a-input",{staticStyle:{width:"90%"},model:{value:t.invoice_detail.remarks,callback:function(a){e.$set(t.invoice_detail,"remarks",a)},expression:"item.invoice_detail.remarks"}})],1),a("a-form-model-item",{attrs:{label:"金额共计",prop:"total"}},[a("a-input-number",{staticStyle:{width:"90%"},attrs:{min:0,max:1e7},model:{value:t.total,callback:function(a){e.$set(t,"total",a)},expression:"item.total"}})],1),a("a-form-model-item",{attrs:{label:"发票类型",prop:"category"}},[a("a-radio-group",{model:{value:t.category,callback:function(a){e.$set(t,"category",a)},expression:"item.category"}},[a("a-radio",{attrs:{value:"CO"}},[e._v(" 交通补贴 ")]),a("a-radio",{attrs:{value:"TO"}},[e._v(" 疗休养 ")]),a("a-radio",{attrs:{value:"RE"}},[e._v(" 亲属供养 ")])],1)],1),a("a-form-model-item",[a("a-button",{staticStyle:{width:"22%"},attrs:{type:"primary"},on:{click:e.submitPaperToRespository}},[e._v(" 完成 ")]),a("a-button",{staticStyle:{width:"22%","margin-left":"5%","margin-right":"15%"},attrs:{href:e.url}},[e._v(" 返回 ")]),a("a-button",{staticStyle:{width:"30%"},on:{click:e.newPaper}},[e._v(" 继续添加 ")])],1)],1)],1)})),1)],1)],1)],1)],1)],1)],1)},r=[];a("a4d3"),a("b64b");function n(e,t){if(null==e)return{};var a,i,r={},n=Object.keys(e);for(i=0;i<n.length;i++)a=n[i],t.indexOf(a)>=0||(r[a]=e[a]);return r}function o(e,t){if(null==e)return{};var a,i,r=n(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)a=o[i],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=a("2909"),c=(a("17ac"),a("ff57")),s=(a("4d63"),a("ac1f"),a("25f0"),a("159b"),a("4de4"),a("fb6a"),a("a434"),a("99af"),a("0fea")),u=a("c1df"),d=a.n(u),m=["key"],b={components:{FormModel:c["a"]},data:function(){return{url:"#/billManage/bill-repository",rules:{number:[{required:!0,message:"请输入发票号码",trigger:"change",len:8}],"invoice_detail.issue_date":[{required:!0,message:"请选择发票日期",trigger:"change"}],total:[{required:!0,message:"请输入发票金额",trigger:"change"}],category:[{required:!0,message:"请选择发票类型",trigger:"change"}]},paperRules:{number:[{required:!0,message:"请输入发票号码",trigger:"change",len:8}],"invoice_detail.remarks":[{required:!0,message:"请输入发票张数",trigger:"change",pattern:new RegExp("^[1-9][0-9]*$")}],total:[{required:!0,message:"请输入发票金额",trigger:"change"}],category:[{required:!0,message:"请选择发票类型",trigger:"change"}]},items:[{key:"1",number:"",total:0,category:"",invoice_detail:{remarks:"1"},closable:!1}],elecItems:[{key:"1",category:"",number:"",total:"",invoice_detail:{issue_date:""}}],closable:!0,activeKey:0,fileList:[],fileListRecognized:[],uploading:!1,headers:{"Content-Type":"multipart/form-data"},upload_status:""}},methods:{onEdit:function(e,t){this[t](e)},onEditElec:function(e,t){"remove"===t&&this.removeElec(e)},remove:function(e){var t,a=this.activeKey;this.items.forEach((function(a,i){a.key===e&&(t=i)}));var i=this.items.filter((function(t){return t.key!==e}));i.length&&a===e&&(a=t>=0?i[t].key:i[0].key);for(var r=e;r<this.items.length;r++)i[r-1].key--;this.items=i,this.activeKey=a},removeElec:function(e){var t,a=this.activeKey,i=this.elecItems.filter((function(t){return t.key!==e}));i.length&&a===e&&(a=t>=0?i[t].key:i[0].key);for(var r=e;r<this.elecItems.length;r++)i[r-1].key--;this.elecItems=i,this.activeKey=a},newPaper:function(e){this.items.push({total:0,key:"".concat(this.items.length+1),category:"",invoice_detail:{remarks:""}})},submitToInvoiceIdentify:function(e){},handleRemove:function(e){var t=this.fileList.indexOf(e),a=this.fileList.slice();a.splice(t,1),this.fileList=a},beforeUpload:function(e){return this.fileList=[].concat(Object(l["a"])(this.fileList),[e]),this.fileListRecognized.push(0),!1},handleUpload:function(){var e=this,t="1";this.elecItems=[];var a=this.fileList;new FormData;a.forEach((function(a){var i=new FormData;i.append("invoice",a),e.uploading=!0,Object(s["v"])(i).then((function(a){var i=d()(a.data.data[0].issue_date,"YYYY-MM-DD");e.elecItems.push({key:t,is_submitted:!1,is_cherked:!1,is_verified:!1,number:a.data.data[0].number,total:a.data.data[0].subtotal_amount,user:1,ownto:1,invoice_detail:{issue_date:i,type:"电子普通发票",code:a.data.data[0].check_code,buyer_name:"中国电信股份有限公司福建分公司",seller_name:"就得及",subtotal_amount:"3.33",subtotal_tax:"3.00",remarks:"",invoice_origin_file:null,invoice_image:null}}),t="".concat(parseInt(t)+1)}))})),this.uploading={delay:2},this.uploading=!1,setTimeout(this.uploading=!1,2e3)},submitToRespository:function(e){for(var t=this,a=function(e){t.$refs["ruleForm"][e].validate((function(a){if(!a)return!1;t.elecItems[e].invoice_detail.issue_date=d()(t.elecItems[e].invoice_detail.issue_date).format("YYYY-MM-DD"),Object(s["t"])(t.elecItems[e]).then((function(a){200===a.data.code?t.$message.success("第"+(e+1)+"张发票：发票号码"+"".concat(t.elecItems[e].number)+"上传成功",10):t.$message.warning("第"+(e+1)+"张发票：发票号码"+"".concat(t.elecItems[e].number)+"上传失败：报错信息为："+"".concat(a.data.number[0]),10)}))}))},i=0;i<this.elecItems.length;i++)a(i)},resetBack:function(){this.$refs[formName][0].resetFields()},submitPaperToRespository:function(){var e=this;this.items[0].closable=!0;for(var t=function(t){e.items[t].is_submitted=!1,e.items[t].is_cherked=!1,e.items[t].is_verified=!1,e.items[t].user=1,e.items[t].total="".concat(e.items[t].total),e.items[t].ownto=1,e.items[t].invoice_detail.type="纸质发票",e.items[t].invoice_detail.buyer_name="中国电信股份有限公司福建分公司";var a=e.items[t],i=(a.key,o(a,m));e.$refs["paperRuleForm"][t].validate((function(a){if(!a)return!1;Object(s["t"])(i).then((function(a){200===a.data.code?e.$message.success("第"+(t+1)+"张发票：发票号码"+"".concat(e.items[t].number)+"上传成功",10):e.$message.warning("第"+(t+1)+"张发票：发票号码"+"".concat(e.items[t].number)+"上传失败：报错信息为："+"".concat(a.data.number[0]),10)}))}))},a=0;a<this.items.length;a++)t(a);this.items[0].closable=!1}}},p=b,f=a("2877"),h=Object(f["a"])(p,i,r,!1,null,null,null);t["default"]=h.exports}}]);